\subsubsubsection{Анализ wavelet} \label{link::wavelet_analysis}
\\\\
\indent Задаемся вопросом \textbf{Q}: Можно ли перейти в пространство времени и частоты, но при этом иметь высокое разрешение, то есть точно понимать, какая и когда частота звучала? \textbf{A}: Перейти в данное пространство можно, однако получить высокое качество нельзя. Эта невозможность обосновывается принципом неопределенности Гейзенберга, первоначально используемом в квантовой механике и гласящем \cite{busch2007heisenberg}, \cite{brunton2022data}, что исходя и структуры и характеристики частиц, невозможно получить наиболее точное представление посредством более точечного анализа в области времени или области частот. То ест устанавливается предел точности. В формализованном виде данное соотношение принимает вид:
\begin{equation}
	\left(\int_{\R}x^2 |f(x)|^2 \; dx \right) \left(\int_{\R}\omega^2 |\hat{f}(x)|^2 \; d \omega \right) \ge \frac{1}{16 \pi^2}
\end{equation}
Однако все-таки переход к анализу частот во времени возможен посредством 1) преобразования Габора \cite{brunton2022data} 2) Wavelet анализу. Преобразование Габора действует по принципу скользящего по исходному сигналу окна, далее для значений сигнала в котором производится анализ Фурье, то есть формируется последовательная сетка из величин частот, а также времени, когда та или иная частота звучали. Однако сама по себе сетка, исходя из примера, приведенного в \cite{brunton2022data}, не является репрезентативной, так как размер окна всегда остается постоянным. 

Далее, делая предпосылку, о необходимости б\'{о}льшего количества времени для низкочастотных компонент сигналат на изменение, а высокочастотных компонент - его меньшее количество, получаем Wavelet преобразование, основанное на применении локализованной волной функции, например:
\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			grid = both,
			legend pos = north west,
			minor tick num = 1,
			major grid style = {lightgray},
			minor grid style = {lightgray!25},
			%title= {},
			width = \textwidth,
			height = 0.45 \textwidth,
			xmin=-4, xmax=4,
			ymin=-5, ymax=5,
			line width=0.3mm
			]
			
			\addplot[domain = -5:5,
			samples = 300,
			color = teal,
			smooth,
			line width = 0.025cm,] {4 * cos(7 * deg(x)) * e^(- (x^2) / 2)};
			
			\legend{$f(t) = 4 \cos(7x)\exp(-x^2 / 2)$};
		\end{axis}
	\end{tikzpicture}
	\caption{Построение wavelet Морле}
\end{figure}
В формализованном виде Wavelet преобразование имеет вид:
\begin{equation}
	\begin{split}
		f(t) & = \frac{1}{2\pi C_{\psi}} \int_{\R} \int_{\R} \frac{W_{\psi}(f_{a, b})}{a^2}\psi_{a, b}(t) \; da \; db\\
		C_{\psi} & = \int_{\R} \frac{|\hat{\phi}(\omega)|^2}{|\omega|} \; d \omega
	\end{split}
\end{equation}
Где $\hat{\phi}(\omega)$ - преобразование Фурье для выбранного в качестве основного Wavelet'а. А формула прямого перехода в пространство частоты и времени, то есть формула прямого Wavelet преобразования, имеет вид:
\begin{equation}
	W_{\psi}(f_{a, b}) = \frac{1}{\sqrt{a}}\int_{\R}f(t) \overline{\phi}\left( \frac{t - b}{a} \right) \; dt
\end{equation}
Где $b$ - параметр, отвечающий за сдвиг функции wavelet по сигналу, параметр $a$ - коэффициент сжатия/растяжения wavelet, а $\overline{\psi}$ - комплексное сопряжение.

Интересно, что отличия от преобразования Фурье минимальны, так как в преобразовании Wavelet просто взяты иные базисные функции, что сохраняет саму структуру действий при проведении подобного анализа. Поэтому все основные свойства, характерные для преобразования Фурье, остаются верными. Более подробно об этом в \cite{brunton2022data}. Графики, которые получаются после проведения данного анализа называются scalograms, что на русском скейлограммы. Далее приводим пример применения Wavelet анализа к показателям Apple.
\begin{figure}[H]
	\centering
	\includegraphics[width= 1.05\textwidth]{time frequency/scalogram_plots.png}
	\caption{График scalogram цены открытия и доходности Apple (IPO - 2022)}
	\label{fig::wavelet_example}
\end{figure}
Интересно, что теперь, по сравнению с анализом Фурье, четко выделено отсутствие какой-либо частотной информации для цен Apple, однако четко прослеживается очень большой ее объем в доходностях. Более того, наблюдая за негативными пиками в доходности, видим, что пики, падающие ниже $-20$ имеют четко выраженную лаговую структура. В верхней части scalogram для доходностей существуют яркие пики, которые аккурат влекут за собой падение доходности, что аналогично предыдущему подтверждает наличие частотной информации и доходностях акций.

Однако конкретно данный алгоритм, как и преобразование Фурье, не получится использовать для прогнозирования, таким образом, их (алгоритмов) главная задача в настоящей работе - обеспечение очистки данных от шумовых компонент, обусловленных как погрешностью, так и временным лагом между наблюдениями - в случае Apple - это примерно $35$ часов.

Теперь приводим пример работы алгоритма очистки посредством применения WA (Wavelet Analysis). Рассматриваем все ту же функцию (\myref{link::illustr_func}).
\begin{figure}[H]
	\centering
	\begin{tikzpicture}
		\begin{axis}[
			grid = both,
			legend pos = north west,
			minor tick num = 1,
			major grid style = {lightgray},
			minor grid style = {lightgray!25},
			%title= {},
			width = \textwidth,
			height = 0.45 \textwidth,
			xmin=-5, xmax=5,
			ymin=-4, ymax=7.5,
			line width=0.3mm
			]
			
			\addplot[color = orange, line width = 0.035cm] table [
			x=x, 
			y=y_clean, 
			col sep=comma,
			mark={},
			] {./source/source_csv/Illustration data/wavelet/wavelet_example_denoising.csv};
			
			\addplot[opacity = 0.25, color = blue] table [
			x=x, 
			y=y_initial, 
			col sep=comma,
			mark={},
			] {./source/source_csv/Illustration data/wavelet/wavelet_example_denoising.csv};
			
			\addplot[domain = -5:5,
			samples = 300,
			color = teal,
			smooth,
			line width = 0.025cm,] {sin(deg(5 * x)) + 1 / 4 * (x^2)};
			
			\legend{$f(x)$ очищенный, $f(x)$ c шумом, $f(x)$ без шума};
		\end{axis}
	\end{tikzpicture}
	\caption{Очистка ряда от шума посредством преобразования Wavelet}
\end{figure}
Ошибка RMSE$= 0.7649$, что заметно больше, что в случае применения метода MSSA, где ошибка $\text{RMSE} = 0.1744$ (\myref{link::mssa}). Таким образом, получается вывод, что для очистки от шума лучше использовать MSSA. Но в таком случае, появляется вопрос \textbf{Q}: Зачем весь этот метод тут, если, применяя его, не получается как прогнозировать (без специальных дополнительных предпосылок или теоретических выкладок, как, например, в статье \cite{schluter2010using}), так и лучше, чем MSSA очищать от шума (не строгое утверждение, а лишь основа на результате исследования настоящей работы)? \textbf{A}: Ответ присутствует в блоке (\myref{link::wavelet_nets}), где приводится описание применения Wavelet анализа к построению <<сетевых>> архитектур. Под <<сетевыми>> подразумеваются нейронные сети.

Таким образом, пока что вышеупомянутые методы Фурье и Wavelet преобразования остаются лишь прикладными к другим методам (это верно только для настоящей работы), так как напрямую для прогнозирования не применяются, однако это ничего не говорит об их качестве работы с анализируемыми данными. Далее переходим к описанию наиболее важной части текущего исследования, посвященной нейросетевому подходу к решению задачи прогнозирования показателей.