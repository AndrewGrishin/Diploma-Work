\section{Подготовительная часть}
	В чем заключается суть данной работы? С концептуальной стороны вопроса ответ очевиден: дан временной ряд, необходимо предсказать его следующее значение наиболее точным образом. Но прежде чем перейти к рассмотрению использованных моделей,  формализуем поставленную задачу, ведь не всегда понятно, что имеется в виду под "наиболее точно"\ и "временной ряд".
	\subsection{Формализация проблемы}
		Пусть на вход программе, назовем ее $f$, подается временной ряд вида: $y_t: t = \overline{1,N}$. Пока что никаких предпосылок относительно данного временного ряда нет. Тогда задача алгоритма $f$ предсказать $\hat{y}_{t + 1}$ так, чтобы значение $|\hat{y}_{t + 1} - y_{t + 1}|$ было минимальным. То есть $f: \mathbb{R}^{N \times 1} \to \mathbb{R} \Rightarrow f(y) = \hat{y}_{t + 1}, \text{где } y = \left(y_1,\ldots,y_N\right)^T$. В терминах глубокого обучения, имеем задачу класса sequence to one \footnote{Sequence to one - задача получения одного значения, исходя из набора данных. К таким задачам относят: семантический анализ текста, классификацию картинок и так далее.} . \textbf{Q}: Но в принципе, что такое временной ряд? \textbf{A}: Временной ряд - это последовательность значений, относящихся к одному объекту в разные моменты времени. То есть, за тот период, когда за объектом наблюдали и снимали показатели. В нашем случае временной ряд - это набор доходностей акций за определенный период времени, то есть не ставится ограничение на знак данных величин, ведь она (доходность) может быть как отрицательной, так и положительной. \textbf{Q}: Почему именно доходности? \textbf{A}: Говоря о них, нет необходимости задумываться о том, сколько реально стоит та или иная акция/ценная бумага: $20$ руб. или $2\text{'}000$ руб. В анализе доходностей нас интересует: насколько они изменяются относительно некоторого момента времени. \textbf{Q}: Какого момента? \textbf{A}: Логично представлять доходность как прирост вида:
		\begin{equation}
			r_{t} = \frac{y_{t} - y_{t - 1}}{y_{t - 1}} = \frac{y_{t}}{y_{t - 1}} - 1
		\end{equation}
		То есть, как изменяется в процентах цена на некоторый актив (не обязательно акцию, хотя в нашем случае именно на нее) относительно предыдущего рабочего дня биржи. Однако внутри самой "акции"\ фигурирует несколько показателей, характеризующих ее в конкретный момент времени: цена открытия, максимальная и минимальная цены, цена закрытия, скорректированная цена закрытия и общая сумма сделок. Акцент делается на анализе цен открытия (так как с точки зрения автора работы важнее всего - хорошо начать рабочий день), хотя несомненно наличие взаимосвязи между ценой открытия и закрытия или иными доступными показателями. Когда есть возможность - другие показатели включаются в анализ, когда нет такой возможности (классическая модель не предназначена) - не включаются. Подводя итог: \textbf{Дано}: $y = \left(y_1, \ldots, y_n\right)^T$, \textbf{Найти}: $\hat{y}_{N + 1}: |\hat{y}_{N + 1} - y_{N + 1}| \to \min$. Подставляя вышеупомянутое равенство, имеем задачу оптимизации:
		\begin{equation}
			|f(y) - y_{N + 1}| \to \min_{\beta \in \mathbb{R}^k}
		\end{equation}
		Где $\beta$ - набор параметров модели, хотя некоторые из них имеют неоптимизируемые параметры (гиперпараметры), но в общем случае задача имеет подобный вид. Но проблема в том, что $y_{N + 1}$ неизвестно, а значит, невозможно подобрать алгоритм абсолютно точного прогнозирования, значит, необходимо на основе имеющейся информации сформировать алгоритм, который наиболее точным образом описывает предложенные ему данные, а далее делает предсказание, причем предсказание, как можно меньше отличающееся от реального значения. Только теперь, проведя подобные рассуждения, мы находимся в области машинного обучения и можем говорить о гипотезах рынка \footnote{Гипотезы рынка - обоснование исследования на качественном уровне, то есть утверждения о возможности проводить какой-либо технический анализ.} . Ведь для каждого типа рынка характерны свои особенности, следовательно, закономерный вопрос: почему мы вообще имеем право пытаться предсказывать что-то для развитой или развивающейся экономик. Изложение двух нижестоящих теорий представлено в сжатом виде, что делает повествование о них поверхностным, но достаточным для понимания всех особенностей работы.
		\subsubsection{Гипотеза эффективного рынка} \label{link::hypothsis_of_msrket_efficiency}
			Это одна из самых неоднозначных в плане количества последователей инвестиционная теория, ставящая своей целью описать принципы движения цен на активы, первоначальная версия которой "представлена"\ Луи Башелье в 1900 году. В его работе показана независимость доходности акций от течения времени, таким образом, Башелье пришел к выводу: "Вероятность роста цены в любой момент времени равна вероятности ее падения, а математическое ожидание спекулянта равно нулю". Много раз менявшая свою формулировку, начиная с Пола Самуэльсона: "На конкурентных рынках на всякого продавца найдется покупатель. Если можно быть уверенным, что цена вырастет, значит, она уже выросла"\ ,  в 1960-ых годах она (гипотеза) приобрела формальный вид в труде Юджина Фамы, использовавшего в исследованиях модель случайного блуждания, выведенную Башелье. По итогам эксперимента, Юджин Фама \cite{efficient_market} привел доказательство того, что вся доступная информация уже заложена в бумагах (позднее: "рынок полностью отражает всю доступную информацию"), то есть бесполезно пытаться предугадывать цены, любое предсказание не сбудется. Более того, единственный фактор, который способен повлиять на цену - это выходящие в будущем новости. А значит, перманентное доминирование над рынком не является возможным, а активное инвестирование не является состоятельным. Более подробная информация изложена в статье от 13 сентября 2022 года \cite{fama_market_efficiency}. На данный момент существует 3 основных гипотезы эффективности рынка:
			\begin{enumerate}
				\item \textbf{Слабая гипотеза} - в цене содержится вся историческая информация об активе и только фундаментальный анализ иногда может обеспечить избыточную доходность.
				\item \textbf{Полусильная гипотеза} - в ценах содержится вся публичная информация, таким образом, избыточную доходность может обеспечить только закрытая от широкой публики информация (инсайдерская).
				\item \textbf{Сильная гипотеза} - в ценах содержится как общедоступная, так и закрытая информация. Таким образом, ничто не может дать инвесторам избыточную доходность по сравнению со среднерыночным показателем.
			\end{enumerate}
			Тогда напрашивается вывод: если быть сторонником ГЭР, то настоящая работа не имеет смысла, ведь технический анализ не может дать дополнительной доходности для любой степени ее силы. Однако, по словам Мартина Свэлла, проанализировавшего историю данной гипотезы в работе \cite{matrin_swell}: "Строго говоря, гипотеза [прежде всего, в ее сильной форме] ложна, но по духу глубоко верна $\ldots$ До тех пор, пока текущая гипотеза не будет заменена лучшей гипотезой, критика имеет ограниченную ценность". Отсюда все-таки следует обоснование, почему существует так много математических моделей, пытающихся прогнозировать доходность активов. Отсюда следует, что в современном мире количество методов предсказания настолько велико, что исследователю сложно выбрать нужный, это еще одно подтверждение, почему настоящая работа имеет смысл.
		\subsubsection{Гипотеза фрактального рынка}
			Часто в качестве доказательства ложности ГЭР приводятся в пример финансовые кризисы, так как по ГЭР вероятность возникновения подобного кризиса пренебрежимо мала или приблизительно ноль. Таким образом, появляется еще одна гипотеза: Гипотеза Фрактального Рынка (ГФР), чьим родоначальником является Бенуа Мандельброт \cite{benoit_mandelbrot}, по которой можно объяснять кризисы. Ее основные характеристики: 1) график доходностей активов имеет фрактальную (всегда $1 < D <2$) размерность 2) Различные окна (интервалы) исходного графика могут быть самоподобными 3) Каждому финансовому графику присуща своя уникальная структура и соответственно ее свойства 4) Финансовый график обладает памятью о своих исходных условиях (имеет долгосрочную память; формальный способ проверки данного утверждения вводится позже). Для выполнения данной гипотезы предполагается, что рынок является стабильным, если он включает в себе очень много инвесторов с различными горизонтами планирования (это гарантия ликвидности). Объяснение кризисов происходит следующим образом, описанным в статье Палювиной А.С. \cite{fractal_market}: "Когда инвесторы меняют свои инвестиционные горизонты (например, фундаментальная информация становится ненадёжной, а	долгосрочные инвесторы уходят с рынка или сокращают свои горизонты),	баланс между краткосрочной и долгосрочной перспективами искажается,	рынок становится менее ликвидным и возникает кризис". Таким образом, из данной гипотезы следует вывод, что информационный и инвестиционный горизонты оказывают влияние на поведение инвестора.
		\subsubsection[Проверяемая гипотеза]{Проверяемая гипотеза настоящего исследования}
			Гипотеза, подтверждение которой настоящая работа ставит одной из своих ключевых задач, заключается в проверке суждения, что нейросетевой (далее NN) поход является наиболее эффективным применительно к исследуемой области финансовых рынков, а точнее к временным рядам цен/доходностей акций. То есть главный вопрос: нейросеть лучше справляется с прогнозированием доходностей акций по цене открытия на один рабочий день биржи по сравнению с другими использованными моделями или нет?
	\subsection{Наиболее популярные методы решения}
		В настоящем исследовании последовательно рассматриваются такие модели как: Exponentially Weighted Moving Average, Auto-regressive Integrated Moving Average, Generalized Auto-Regressive Conditional Heteroskedasticity, Auto-regressive Fractionally Integrated Moving Average, Fractionally Integrated GARCH, Singular Spectrum Analysis, Fourier \& Wavelet analysis, а также Transformers и моделирование сезонности. Далее рассказывается подробнейшим образом о математической подоплеке каждой из моделей. Важно понимать, что у данной работы нет задачи предоставить полноценное обоснование, почему та или иная модель однозначно работает, однако где-то все-таки приводится подробное описание, а где-то лишь качественные рассуждения и ссылки на более подробное обоснование. Сразу стоит отметить, обращаясь к последнему пункту плана (Transformers и моделирование сезонности), что он рассматривается с точки зрения: почему он тут не нужен \cite{transformers_are_useless_for_TSF}, несмотря на революцию в Natural Language Processing, устроенную методом self-attention \cite{attention_transformers} и несмотря на важный аспект моделирования временных рядов - сезонность. Механизм self-attention создан для вычленения смысла из данных. То есть: дан набор слов, к ему в соответствие ставится вектор (она называется embedding), а после к данному набору чисел применяются известные алгоритмы ML или DL. Однако в текущей задаче в ряде доходстей или цен (одно можно получить из другого) нет контекста, то есть и сам механизм теряет свою значимость. Трансформеры оперируют понятием контекста, отвечающего за связь слова с окружающими его словами. Математически-интуитивно это можно рассматривать следующим образом: $\{w_j\}_{j=1}^n$ - все предложение, смотрим на конкретное слово (не в начале и не в конце: между словом и концом/началом должно быть как минимум еще одно слово) $w_i: i \in (1,n)$. Контекстом данного слова называется набор $w_k: k \in \{i - l, \ldots, i - 1, i + 1, \ldots, i + l\}: l \in \N$. тут пропущено само слово, так как для него окно одного размера влево и вправо является контекстом. Это значит, что при таком последовательном выборе контекста необходимо максимизировать вероятность получения конкретного слова $w_i$. Данная задача ставится в процессе создания качественного эмебддинга (сопоставления чисел словам; алгоритм Word2Vec \cite{word2vec_2013}), но в текущей задаче нет необходимости рассматривать такую смысловую взаимосвязь между величинами ряда, так как, исходя из качественных рассуждений, на вход подается единственное число, которое никак, с точки зрения смысла, не связано с другими. Исходя из этого и делается вывод, что механизм трансформеров проигрывает более простым линейным моделям \cite{transformers_are_useless_for_TSF}. Что касается сезонности, то, несмотря на подтверждение ее наличия в финансовых временных рядах \cite{seasonality_in_financial_TS_is_real}, все-таки рассматриваем модели без корректировки на данную составляющую. Подобное рассуждения приводится, опираясь на Гипотезу Эффективного Рынка, утверждающую, что финансовые временные ряды не зависят от времени, иначе рынок перестал бы быть эффективным \cite{seasonality_test_for_financial_stock_market}. Данное суждение весьма прозаично относительно показанного факта в блоке \ref{link::hypothsis_of_msrket_efficiency} о некорректности всей гипотезы в целом. В итоге получается, что из ГЭР рассматривается (принимается как верное) только суждение об отсутствии сезонности, а все остальные положения принимаются как ложные. Таким образом, в данной работе не рассматриваются как Трансформеры, так и сезонность ряда (даже если эта составляющая присутствует, то она все равно относится к шуму). Далее приступаем к описанию моделей, рассматриваемых в настоящей работе. Для удобства делим их на требующие стационарность и не требующие. \textbf{Q}: Что такое стационарность? \textbf{A}: Существует определение как для случая, когда 1) временной ряд воспринимается как последовательная реализация случайных величин как-то распределенных, так и для случая, когда 2) временной ряд - некоторый сигнал, например, от светодиода или от звукового динамика. Последовательно:
		\begin{enumerate}
			\item Временной ряд - реализация набора зависимых случайных величин с различным - изменяющимся во времени - распределением. Случайная выборка - простейший частный случай для временного ряда, так как все полученные данные являются следствием реализации не одной случайной величины с некоторым распределением, а некоторого набора. Данные распределения заранее неизвестны и их пока что не представляется физической возможности определить, так как для их определения необходимо было бы посетить параллельную вселенную, где данная величина реализовалась бы иначе. То есть для максимальной точности потребовалось бы посещения $n \to \infty$ параллельных вселенных. Отсюда и возможность оперировать только частными случаями временных рядов - случайной выборкой. Таким образом, под всеми последующими упоминаниями термина "временной ряд"\ понимается термин "случайная выборка"\ - частный случай реализации временного ряда. Для данного определения существуют 2 понятия стационарности: в узком (сильном) и в широком (слабом) смыслах. Взяты из работы  Н. В. Артамонова, Е. А. Ивина \cite{stationarity_of_time_series_econometrics}, но переработаны для удобства восприятия.
			\begin{definition} \label{def::strong_ts_stationarity}
				\textbf{Если}: $\forall p, t_1, \ldots, t_p, l \in \mathbb{N} \Rightarrow$ распределение $y_{t_1}, y_{t_2}, \ldots y_{t_p}$ идентично распределению $y_{t_1 + l}, y_{t_2 + l}, \ldots, y_{t_p + l}$. \textbf{То}: Временной ряд называется стационарным в узком смысле (строго стационарным).
			\end{definition}
			\begin{definition} \label{def::weak_ts_stationarity}
				\textbf{Если}: $\forall t \in \mathbb{N} \Rightarrow \E(y_t) = \mu \in \R, \V(y_t) = \gamma_0, \cov(y_t, y_{t - k}) = \gamma_k: \mu, \gamma_0, \gamma_k$ не зависят от $t$. \textbf{То}: Временной ряд называется стационарным в широком смысле (слабо стационарным).
			\end{definition}
 			\item Временной ряд - просто набор чисел, содержащий информацию об объекте и полученный в ходе эксперимента (наблюдения за объектом). В этом случае стационарности дается следующее определение:
 			\begin{definition} \label{def::signal_stationarity}
 				\textbf{Если}: спектр амплитуд сигнала является постоянным во времени. \textbf{То}: Сигнал называется стационарным.
 			\end{definition}
 			В данном случае имеет место деление: стационарный, значит, либо детерминированный (то есть: однозначно определяется по некоторому закону и является периодическим/квазипериодическим/непериодическим), либо случайный (например, модели финансового рынка, основанного на Броуновском Движении \cite{brownian_motion_for_stochastic_differential_equation} или Белом шуме \cite{white_noise_for_stochastic_differential_equation}); нестационарный, значит, непрерывный или переходный. Более подробно о данном понятии и формальном его осознании рассказывается в блоках \ref{link::fourier_analysis} (Анализ Фурье) и \ref{link::wavelet_analysis} (Wavelet анализ).
		\end{enumerate}
		Исходя из вышеперечисленных определений, выделяем 2 группы моделей: стационарные и нестационарные. Стационарные модели - те, для которых необходимо выполнение предпосылки о слабой (стр. \pageref{def::weak_ts_stationarity} опр. \ref{def::weak_ts_stationarity}) или сильной (стр. \pageref{def::strong_ts_stationarity} опр. \ref{def::strong_ts_stationarity}) стационарности. Нестационарные - те, для которых нет строгой необходимости в этом (они могут работать как со стационарными данными, так и с нестационарными).		
		
		\input{./source/source_tex/models/ewma}
		\input{./source/source_tex/models/arima}
		\input{./source/source_tex/models/grach}
		\input{./source/source_tex/models/arfima}
		\input{./source/source_tex/models/figarch}
		\input{./source/source_tex/models/ssa}
		\input{./source/source_tex/models/fourier}
		\input{./source/source_tex/models/wavelet}
		\input{./source/source_tex/models/nn}
		